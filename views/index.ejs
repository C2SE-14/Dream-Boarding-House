<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link
    rel="stylesheet"
    type="text/css"
    href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"
  />
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  </head>
  <body>
    <div class="container">
      <%- include('./components/header')%>
      <div class="banner">
        <img src="https://gotrangtri.vn/wp-content/uploads/2021/04/thiet-ke-noi-that-chung-cu-bia.jpg.webp" alt="căn hộ" class="img-banner">
      </div>
      <div class="list-room">
        <%for(let i = 0; i < listRoom.length; i++) {%>
          <div class="room-item">
            <a href="/room/<%=listRoom[i]._id%>">
              <div class="room">
                <div class="image-room">
                  <img src="https://images.cenhomes.vn/2020/03/1585033148-can-ho-mau-an-land-complex.jpg" alt="">
                </div>
                <h3 class="type">Kiểu phòng: <%=listRoom[i].type%></h3>
                <div class="acreage">Diện tích: <%=listRoom[i].acreage%></div>
                <div class="address">Địa chỉ: <%=listRoom[i].address%></div>
                <div class="description">Mô tả: <%=listRoom[i].description%></div>
                <div class="description">Giá phòng: <%=listRoom[i].price%></div>
                <% if(listRoom[i].state === true){%>
                  <div class="state" style="color: green">Tình trạng: Còn phòng</div>
                <% } %>
                <div class="poster">Người đăng tải: <%=listRoom[i].username%></div>
                <% if(user) {%>
                <!-- <form action="/favoriteList/room/like/<%=listRoom[i]._id%>" method="POST" onsubmit="handleSubmit">
                  <input type="submit" value="Yêu thích" class="btn-like"/>
                </form> -->
                <% } %>
              </div>
            </a>
            <!-- <form action="" method="POST" id="form-like"> -->
              <%if(listRoom[i].isLike === false) { %>
              <button type="submit" class="btn-like" data-id="<%=listRoom[i]._id%>">yêu thích</button>
              <%} else {%>
                <button type="submit" class="btn-like" data-id="<%=listRoom[i]._id%>" style="Background-color:#ff7979;">yêu thích</button>
              <%}%>
            <!-- </form> -->
          </div>
        <% } %>
      </div>
      <div class="list-room">
        <div class="room">
          <div class="image-room">
            <img src="https://behouse.vn/wp-content/uploads/2021/03/phong-tro-dep.jpg" alt="">
          </div>
          <h3 class="type">Phòng trọ</h3>
          <div class="acreage">32m2</div>
          <div class="address">02 Khuê Trung. Hòa Cường Nam, Hải Châu, Đà Nẵng</div>
          <div class="description">Phòng trọ rộng rãi, thoáng mát</div>
        </div>
        <div class="room">
          <div class="image-room">
            <img src="https://behouse.vn/wp-content/uploads/old/phong-tro-dep-3_1615736824.jpg" alt="">
          </div>
          <h3 class="type">Phòng trọ</h3>
          <div class="acreage">25m2</div>
          <div class="address">Cách mạng tháng 8, Hòa Cường Nam, Hải Châu, Đà Nẵng</div>
          <div class="description">Phòng trọ rộng rãi, thoáng mát</div>
        </div>
        <div class="room">
          <div class="image-room">
            <img src="https://behouse.vn/wp-content/uploads/old/phong-tro-dep-7_1615736985.jpg" alt="">
          </div>
          <h3 class="type">Phòng trọ</h3>
          <div class="acreage">40m2</div>
          <div class="address"> 56 Bạch Đằng, Hòa Cường Nam, Hải Châu, Đà Nẵng</div>
          <div class="description">Phòng trọ rộng rãi, thoáng mát</div>
        </div>
        <div class="room">
          <div class="image-room">
            <img src="https://behouse.vn/wp-content/uploads/old/phong-tro-dep-6_1615736964.jpg" alt="">
          </div>
          <h3 class="type">Phòng trọ</h3>
          <div class="acreage">18m2</div>
          <div class="address">02 Khuê Trung. Hòa Cường Nam, Hải Châu, Đà Nẵng</div>
          <div class="description">Phòng trọ rộng rãi, thoáng mát</div>
        </div>
      </div>
      <!-- Toast like successfully-->
      <div role="alert" aria-live="assertive" aria-atomic="true" class="toast" data-autohide="false">
        <div class="toast-header">
          <img src="..." class="rounded mr-2" alt="...">
          <strong class="mr-auto">Bootstrap</strong>
          <small>11 mins ago</small>
          <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body">
          Hello, world! This is a toast message.
        </div>
      </div>
      <%- include('./components/footer')%>
    </div>
      <script>
        const likeBtn = document.getElementsByClassName("btn-like");
        console.log(likeBtn);
        const formLike = document.getElementById("form-like");
        console.log('formLike: ', formLike);
        Array.prototype.forEach.call(likeBtn, (btn) => {
              btn.addEventListener('click', function(e) {
                const roomId = btn.getAttribute('data-id');
                const option = {
                  animation: true,
                  autohide: true,
                  delay: 5000
                }
                let msg = '';
                  $.ajax({
                    url: `/favoriteList/room/like/${roomId}`,
                    type: "POST",
                    success: function (response) {
                      if(response.msg === "Đã yêu thích") {
                        msg = response.msg;
                        $('.toast').toast('show');
                      }
                    }
                  });
              })
        })
      </script>
    <script>
      $(".list-room").slick({
      infinite: true,
      speed: 300,
      slidesToShow: 4,
      slidesToScroll: 4,
      autoplay: true,
      prevArrow:
        "<button type='button' class='slick-prev pull-left'><i class='fa fa-angle-left' aria-hidden='true'></i></button>",
      nextArrow:
        "<button type='button' class='slick-next pull-right'><i class='fa fa-angle-right' aria-hidden='true'></i></button>",
      responsive: [
        {
          breakpoint: 1024,
          settings: {
            slidesToShow: 3,
            slidesToScroll: 3,
            infinite: true,
            prevArrow: false,
            nextArrow: false,
          },
        },
        {
          breakpoint: 600,
          settings: {
            slidesToShow: 2,
            slidesToScroll: 2,
            prevArrow: false,
            nextArrow: false,
          },
        },
        {
          breakpoint: 480,
          settings: {
            slidesToShow: 1,
            slidesToScroll: 1,
            prevArrow: false,
            nextArrow: false,
          },
        },
      ],
  });
    </script>
  </body>
</html>
