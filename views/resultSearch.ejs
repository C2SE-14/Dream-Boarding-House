<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel="stylesheet" type="text/css" href="slick/slick.css"/>
<link rel="stylesheet" type="text/css" href="slick/slick-theme.css"/>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
    <link rel='stylesheet' href='/stylesheets/resultSearch.css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  </head>
  <body>
    <div class="container">
      <%- include('./components/header')%>
      <h3>Có <%=listRoom.length%> kết quả được tìm thấy</h3>
      <div class="list-room-search">
        <%for(let i = 0; i < listRoom.length; i++) {%>
          <div class="room-item-search">
            <a href="/room/<%=listRoom[i]._id%>">
              <div class="room">
                <div class="image-room">
                  <img src="https://images.cenhomes.vn/2020/03/1585033148-can-ho-mau-an-land-complex.jpg" alt="">
                </div>
                <!-- <h3 class="type">Kiểu phòng: <%=listRoom[i].type%></h3> -->
                <div class="acreage">Diện tích: <%=listRoom[i].acreage%></div>
                <div class="address">Địa chỉ: <%=listRoom[i].address%></div>
                <div class="description">Mô tả: <%=listRoom[i].description%></div>
                <div class="description">Giá phòng: <%=listRoom[i].price%></div>
                <% if(listRoom[i].state === true){%>
                  <div class="state" style="color: green">Tình trạng: Còn phòng</div>
                <% } %>
                <div class="poster">Người đăng tải: <%=listRoom[i].username%></div>
                <% if(user) {%>
                <!-- <form action="/favoriteList/room/like/<%=listRoom[i]._id%>" method="POST" onsubmit="handleSubmit">
                  <input type="submit" value="Yêu thích" class="btn-like"/>
                </form> -->
                <% } %>
              </div>
            </a>
            <!-- <form action="" method="POST" id="form-like"> -->
              <%if(listRoom[i].isLike === false) { %>
              <button type="submit" class="btn-like" data-id="<%=listRoom[i]._id%>">yêu thích</button>
              <%} else {%>
                <button type="submit" class="btn-like" data-id="<%=listRoom[i]._id%>" style="Background-color:#ff7979;">yêu thích</button>
              <%}%>
            <!-- </form> -->
          </div>
        <% } %>
      </div>
      
      <!-- Toast like successfully-->
      <!-- <div role="alert" aria-live="assertive" aria-atomic="true" class="toast" data-autohide="false">
        <div class="toast-header">
          <img src="..." class="rounded mr-2" alt="...">
          <strong class="mr-auto">Bootstrap</strong>
          <small>11 mins ago</small>
          <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body">
          Hello, world! This is a toast message.
        </div>
      </div> -->
      <%- include('./components/footer')%>
      <script>
        const likeBtn = document.getElementsByClassName("btn-like");
        console.log(likeBtn);
        const formLike = document.getElementById("form-like");
        console.log('formLike: ', formLike);
        Array.prototype.forEach.call(likeBtn, (btn) => {
              btn.addEventListener('click', function(e) {
                const roomId = btn.getAttribute('data-id');
                const option = {
                  animation: true,
                  autohide: true,
                  delay: 5000
                }
                let msg = '';
                  $.ajax({
                    url: `/favoriteList/room/like/${roomId}`,
                    type: "POST",
                    success: function (response) {
                      if(response.msg === "Đã yêu thích") {
                        msg = response.msg;
                        btn.style.backgroundColor = "#ff7979";
                        $('.toast').toast('show');
                      }
                    }
                  });
              })
        })
      </script>
    </div>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script type="text/javascript" src="slick/slick.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
<script>
  $('.list-room').slick({
  lazyLoad: 'ondemand',
  slidesToShow: 4,
  slidesToScroll: 1
});
</script>
  </body>
</html>
